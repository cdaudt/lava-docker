device_type: ifc610plus
job_name: ifc6410plus-pipeline-fastboot

timeouts:
  actions:
    apply-overlay-image:
      minutes: 4
    umount-retry:
      seconds: 57
    lava-test-shell:
      seconds: 600
  job:
    minutes: 45
  action:
    minutes: 20
priority: medium
visibility: public

protocols:
  lava-lxc:
    name: lxc-ifc6410plus-test
    template: debian
    distribution: debian
    release: sid
    arch: amd64

actions:
- deploy:
    namespace: tlxc
    timeout:
      minutes: 10
    to: lxc
    packages:
    - android-tools-adb
    - android-tools-fastboot
    os: debian

- boot:
    namespace: tlxc
    prompts:
    - 'root@(.*):.#'
    timeout:
      minutes: 5
    method: lxc

- deploy:
    timeout:
      minutes: 10
    to: fastboot
    namespace: dut
    connection: lxc
    images:
      boot:
        url: http://rodan.ric.broadcom.com/images/boot-qcom-apq8064-ifc6410-qcom-snapdragon-20160824-76.img
      system:
        url: http://rodan.ric.broadcom.com/images/firmware-qcom-snapdragon-20160824-76.img
      userdata:
        url: http://rodan.ric.broadcom.com/images/linaro-jessie-developer-qcom-snapdragon-20160824-76.img
    os: debian

- boot:
    namespace: dut
    prompts:
    - 'root@(.*):.#'
    timeout:
      minutes: 5
    method: fastboot
    failure_retry: 2
    connection: lxc

- deploy:
    timeout:
      minutes: 1
    to: tftp
    namespace: dut
    os: debian_tftpoverlay

- test:
    failure_retry: 3
    name: kvm-basic-singlenode
    namespace: dut
    timeout:
      minutes: 10 # uses install:deps, so takes a few minutes
    definitions:
        - repository: git://git.ric.broadcom.com/users/csd/lava/test-definitions.git
          from: git
          path: ubuntu/smoke-tests-basic.yaml
          name: smoke-tests
        - repository: git://git.ric.broadcom.com/users/csd/lava/lava-functional-tests
          from: git
          path: lava-test-shell/single-node/singlenode03.yaml
          name: singlenode-advanced
